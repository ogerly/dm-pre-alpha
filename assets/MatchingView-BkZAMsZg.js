import{b as A,e as i,f as s,g as F,w as U,h as L,n as x,v as w,H as M,l as C,F as b,i as f,t as g,a as m,p as _,o,k as V}from"./vendor-DZFa3d4i.js";import{_ as N,u as $,a as B,b as I,e as v}from"./index-D5K5PIh6.js";const K=A({name:"MatchingView",setup(){const t=$(),e=B(),y=I(),d=m([]),p=m(""),a=m([]),c=m(""),l=m([]),r=m(!1),k=m(!1);return _(async()=>{if(e.isAuthenticated&&e.user&&(d.value=e.user.skills||[],!t.users.length))try{await t.loadUsers()}catch(n){v.error("Failed to load users for matching",n)}}),{userStore:t,authStore:e,uiStore:y,userSkills:d,newSkill:p,desiredSkills:a,newDesiredSkill:c,matches:l,isLoading:r,isSaving:k,addSkill:()=>{p.value.trim()&&(d.value.includes(p.value.trim())||d.value.push(p.value.trim()),p.value="")},removeSkill:n=>{d.value.splice(n,1)},saveSkills:async()=>{if(e.isAuthenticated)try{k.value=!0,e.user&&(t.updateUser(e.user.id,{skills:[...d.value]}),e.user.skills=[...d.value],v.info("User skills saved",{userId:e.user.id,skillCount:d.value.length}))}catch(n){v.error("Failed to save skills",n)}finally{k.value=!1}},addDesiredSkill:()=>{c.value.trim()&&(a.value.includes(c.value.trim())||a.value.push(c.value.trim()),c.value="")},removeDesiredSkill:n=>{a.value.splice(n,1)},findMatches:async()=>{if(!(!e.isAuthenticated||a.value.length===0))try{r.value=!0,t.users.length===0&&await t.loadUsers();const n=t.users.filter(u=>{var h;return u.id!==((h=e.user)==null?void 0:h.id)}).map(u=>{const h=(u.skills||[]).filter(D=>a.value.includes(D));let S=0;return a.value.length>0&&(S=h.length/a.value.length),{...u,matchScore:S,matchingSkills:h}}).filter(u=>u.matchingSkills.length>0).sort((u,h)=>h.matchScore-u.matchScore);l.value=n,v.info("Matching completed",{searchedFor:a.value.length,matchesFound:l.value.length})}catch(n){v.error("Error finding matches",n)}finally{r.value=!1}},contactMatch:n=>{y.toggleChat(),v.info("User initiated contact",{targetUserId:n.id,targetUserName:n.name})}}}}),P={class:"container mx-auto p-4"},T={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},j={class:"bg-white p-6 rounded-lg shadow-md"},E={key:0,class:"text-center p-4 bg-gray-100 rounded-lg"},H={key:1},Y={class:"mb-4"},O={class:"flex flex-wrap gap-2 mb-4"},R=["onClick"],W={key:0,class:"text-gray-500 text-sm pt-2"},q=["disabled"],z={class:"bg-white p-6 rounded-lg shadow-md"},G={key:0,class:"text-center p-4 bg-gray-100 rounded-lg"},J={key:1},Q={class:"mb-4"},X={class:"flex flex-wrap gap-2 mb-4"},Z=["onClick"],ee={key:0,class:"text-gray-500 text-sm pt-2"},se=["disabled"],te={class:"bg-white p-6 rounded-lg shadow-md"},le={key:0,class:"text-center p-4"},ie={key:1,class:"text-center p-4 bg-gray-100 rounded-lg"},oe={key:2,class:"text-center p-4 bg-gray-100 rounded-lg"},ne={key:3,class:"space-y-4"},re={class:"flex justify-between items-start"},ae={class:"font-medium"},de={class:"text-gray-500 text-sm"},ue={class:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded"},ge={class:"mt-2"},ce={class:"flex flex-wrap gap-1"},he={class:"mt-3 flex justify-end"},me=["onClick"];function pe(t,e,y,d,p,a){const c=L("router-link");return o(),i("div",P,[e[16]||(e[16]=s("h1",{class:"text-2xl font-bold mb-4"}," Skill Matching ",-1)),e[17]||(e[17]=s("div",{class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},[s("h2",{class:"text-lg font-semibold text-blue-800 mb-2"}," How Matching Works "),s("p",{class:"text-blue-700"}," Our matching algorithm finds people with complementary skills. Select your skills and interests below, and we'll show you potential matches that might be a good fit for collaboration. ")],-1)),s("div",T,[s("div",j,[e[8]||(e[8]=s("h2",{class:"text-lg font-semibold mb-4"}," Your Skills ",-1)),t.authStore.isAuthenticated?(o(),i("div",H,[s("div",Y,[x(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>t.newSkill=l),type:"text",placeholder:"Add a skill...",class:"px-3 py-2 border border-gray-300 rounded-md w-full",onKeyup:e[1]||(e[1]=M((...l)=>t.addSkill&&t.addSkill(...l),["enter"]))},null,544),[[w,t.newSkill]])]),s("div",O,[(o(!0),i(b,null,f(t.userSkills,(l,r)=>(o(),i("div",{key:r,class:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full flex items-center"},[s("span",null,g(l),1),s("button",{class:"ml-2 text-blue-600 hover:text-blue-800",onClick:k=>t.removeSkill(r)}," × ",8,R)]))),128)),t.userSkills.length===0?(o(),i("p",W," No skills added yet. Add some skills to see matches. ")):C("",!0)]),s("div",null,[s("button",{class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 w-full",disabled:t.isSaving,onClick:e[2]||(e[2]=(...l)=>t.saveSkills&&t.saveSkills(...l))},g(t.isSaving?"Saving...":"Save Skills"),9,q)])])):(o(),i("div",E,[e[7]||(e[7]=s("p",{class:"text-gray-600 mb-3"}," Please login to set your skills and see matches ",-1)),F(c,{to:"/login",class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 inline-block"},{default:U(()=>e[6]||(e[6]=[V(" Login ")])),_:1})]))]),s("div",z,[e[10]||(e[10]=s("h2",{class:"text-lg font-semibold mb-4"}," Skills You're Looking For ",-1)),t.authStore.isAuthenticated?(o(),i("div",J,[s("div",Q,[x(s("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>t.newDesiredSkill=l),type:"text",placeholder:"Add a desired skill...",class:"px-3 py-2 border border-gray-300 rounded-md w-full",onKeyup:e[4]||(e[4]=M((...l)=>t.addDesiredSkill&&t.addDesiredSkill(...l),["enter"]))},null,544),[[w,t.newDesiredSkill]])]),s("div",X,[(o(!0),i(b,null,f(t.desiredSkills,(l,r)=>(o(),i("div",{key:r,class:"bg-green-100 text-green-800 px-3 py-1 rounded-full flex items-center"},[s("span",null,g(l),1),s("button",{class:"ml-2 text-green-600 hover:text-green-800",onClick:k=>t.removeDesiredSkill(r)}," × ",8,Z)]))),128)),t.desiredSkills.length===0?(o(),i("p",ee," Add skills that you're looking for in others. ")):C("",!0)]),s("div",null,[s("button",{class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 w-full",disabled:t.isLoading||t.desiredSkills.length===0,onClick:e[5]||(e[5]=(...l)=>t.findMatches&&t.findMatches(...l))},g(t.isLoading?"Finding Matches...":"Find Matches"),9,se)])])):(o(),i("div",G,e[9]||(e[9]=[s("p",{class:"text-gray-600"}," Please login to set preferences ",-1)])))]),s("div",te,[e[15]||(e[15]=s("h2",{class:"text-lg font-semibold mb-4"}," Potential Matches ",-1)),t.isLoading?(o(),i("div",le,e[11]||(e[11]=[s("div",{class:"inline-block animate-spin h-6 w-6 border-4 border-blue-500 border-t-transparent rounded-full"},null,-1),s("p",{class:"mt-2 text-gray-600"}," Finding matches... ",-1)]))):t.authStore.isAuthenticated?t.matches.length===0?(o(),i("div",oe,e[13]||(e[13]=[s("p",{class:"text-gray-600"},' No matches found yet. Try adding more desired skills or click "Find Matches". ',-1)]))):(o(),i("div",ne,[(o(!0),i(b,null,f(t.matches,l=>(o(),i("div",{key:l.id,class:"border border-gray-200 p-4 rounded-lg hover:bg-gray-50"},[s("div",re,[s("div",null,[s("h3",ae,g(l.name),1),s("p",de,g(l.email),1)]),s("span",ue,g(Math.round(l.matchScore*100))+"% match ",1)]),s("div",ge,[e[14]||(e[14]=s("p",{class:"text-sm text-gray-600 font-medium mb-1"}," Matching skills: ",-1)),s("div",ce,[(o(!0),i(b,null,f(l.matchingSkills,r=>(o(),i("span",{key:r,class:"bg-green-50 text-green-700 text-xs px-2 py-1 rounded"},g(r),1))),128))])]),s("div",he,[s("button",{class:"text-blue-600 hover:text-blue-800 text-sm font-medium",onClick:r=>t.contactMatch(l)}," Contact ",8,me)])]))),128))])):(o(),i("div",ie,e[12]||(e[12]=[s("p",{class:"text-gray-600"}," Login to see your matches ",-1)])))])])])}const Ce=N(K,[["render",pe]]);export{Ce as default};
